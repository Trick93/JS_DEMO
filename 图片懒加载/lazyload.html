<!DOCTYPE html>
<html>
<head>
	<title>图片懒加载</title>
	<style type="text/css">
		img{
			display: block;
			margin-bottom: 50px;
			width: 400px;
			height: 400px;
		}
	</style>
</head>
<body>
	
	<img src="loading.gif" data-src="http://ww4.sinaimg.cn/large/006y8mN6gw1fa5obmqrmvj305k05k3yh.jpg" alt="">
	<img src="loading.gif" data-src="http://ww4.sinaimg.cn/large/006y8mN6gw1fa5obmqrmvj305k05k3yh.jpg" alt="">
	<img src="loading.gif" data-src="http://ww4.sinaimg.cn/large/006y8mN6gw1fa5obmqrmvj305k05k3yh.jpg" alt="">
	<img src="loading.gif" data-src="http://ww4.sinaimg.cn/large/006y8mN6gw1fa5obmqrmvj305k05k3yh.jpg" alt="">
	<img src="loading.gif" data-src="http://ww4.sinaimg.cn/large/006y8mN6gw1fa5obmqrmvj305k05k3yh.jpg" alt="">
	<img src="loading.gif" data-src="http://ww4.sinaimg.cn/large/006y8mN6gw1fa5obmqrmvj305k05k3yh.jpg" alt="">
	<img src="loading.gif" data-src="http://ww4.sinaimg.cn/large/006y8mN6gw1fa5obmqrmvj305k05k3yh.jpg" alt="">
	<img src="loading.gif" data-src="http://ww4.sinaimg.cn/large/006y8mN6gw1fa5obmqrmvj305k05k3yh.jpg" alt="">
	<img src="loading.gif" data-src="http://ww4.sinaimg.cn/large/006y8mN6gw1fa5obmqrmvj305k05k3yh.jpg" alt="">
	<img src="loading.gif" data-src="http://ww4.sinaimg.cn/large/006y8mN6gw1fa5obmqrmvj305k05k3yh.jpg" alt="">
	<img src="loading.gif" data-src="http://ww4.sinaimg.cn/large/006y8mN6gw1fa5obmqrmvj305k05k3yh.jpg" alt="">
	<img src="loading.gif" data-src="http://ww4.sinaimg.cn/large/006y8mN6gw1fa5obmqrmvj305k05k3yh.jpg" alt="">
	<img src="loading.gif" data-src="http://ww4.sinaimg.cn/large/006y8mN6gw1fa5obmqrmvj305k05k3yh.jpg" alt="">
	<img src="loading.gif" data-src="http://ww4.sinaimg.cn/large/006y8mN6gw1fa5obmqrmvj305k05k3yh.jpg" alt="">
	<img src="loading.gif" data-src="http://ww4.sinaimg.cn/large/006y8mN6gw1fa5obmqrmvj305k05k3yh.jpg" alt="">
	<img src="loading.gif" data-src="http://ww4.sinaimg.cn/large/006y8mN6gw1fa5obmqrmvj305k05k3yh.jpg" alt="">
	<img src="loading.gif" data-src="http://ww4.sinaimg.cn/large/006y8mN6gw1fa5obmqrmvj305k05k3yh.jpg" alt="">
	<img src="loading.gif" data-src="http://ww4.sinaimg.cn/large/006y8mN6gw1fa5obmqrmvj305k05k3yh.jpg" alt="">
	<img src="loading.gif" data-src="http://ww4.sinaimg.cn/large/006y8mN6gw1fa5obmqrmvj305k05k3yh.jpg" alt="">
	<img src="loading.gif" data-src="http://ww4.sinaimg.cn/large/006y8mN6gw1fa5obmqrmvj305k05k3yh.jpg" alt="">
	<img src="loading.gif" data-src="http://ww4.sinaimg.cn/large/006y8mN6gw1fa5obmqrmvj305k05k3yh.jpg" alt="">
	<img src="loading.gif" data-src="http://ww4.sinaimg.cn/large/006y8mN6gw1fa5obmqrmvj305k05k3yh.jpg" alt="">

	<script type="text/javascript">
		var num = document.getElementsByTagName('img').length;
		var img = document.getElementsByTagName('img');
		var n = 0;//存储图片加载到的位置，避免每次从第一张开始遍历

		lazyload();

		//window.onscroll = lazyload;

		function lazyload(){
			var seeHeight = document.documentElement.clientHeight;
			var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
			for(var i=n; i<num; i++){
				if(img[i].offsetTop < seeHeight + scrollTop){
					if(img[i].getAttribute("src") == "loading.gif"){console.log("ll");
						img[i].src = img[i].getAttribute("data-src");
					}
					n = i + 1;
				}
			}
		}

		//节流函数
		//fum要执行的函数  delay延迟  time在time时间内必须执行一次
		function throttle(fun,delay,time){
			var timeout,
				startTime = new Date();

			return function(){
				var context = this;
					args = arguments;
					curTime = new Date();

				clearTimeout(timeout);
				//达到规定时间间隔触发
				if(curTime - startTime >= time){
					fun.apply(context,args);
					startTime = curTime;
					//没达到触发间隔，重新设定定时器
				} else{
					timeout = setTimeout(function(){
						fun.apply(context,args);
					},delay)
				}
			}
		}
		window.addEventListener('scroll',throttle(lazyload,500,1000));
	</script>
</body>
</html>